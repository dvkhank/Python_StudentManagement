{% extends 'layout/base.html' %}
{% block content %}
<div class="container" style="margin-top:120px">
    <h1 class="mb-4">Create Student'Score</h1>
    <form action="/create_scoresheet/add?student_id_add={{student.id}}" method="post" id="scoresheetForm">
        <table class="table">
            <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Last Name</th>
                <th scope="col">First Name</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <input type="hidden" name="student_id" value="{{student.id}}">
                <th scope="col"> {{student.id}}</th>
                <td>{{student.last_name}}</td>
                <td>{{student.first_name}}</td>
            </tr>
            </tbody>
        </table>
        <table class="table">
            <thead>
            <tr>
                <th scope="col">Type of score</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="col">15p</th>
                {% for i in range (rule_15p.min) %}
                <td><input class="score15p" type="number" min="0" max="10" step="0.1" name="score15p"></td>
                {% endfor %}
                <td><i style="cursor: pointer" class="fa-solid fa-circle-plus" onclick="createScore(this, 1)"></i></td>
            </tr>
            <tr>
                <th scope="col">1Tiet</th>
                <td><input class="score1tiet" type="number" min="0" max="10" step="0.1" name="score1tiet"></td>
                <td><i style="cursor: pointer" class="fa-solid fa-circle-plus" onclick="createScore(this, 2)"></i></td>
            </tr>
            <tr>
                <th scope="col">CuoiKi</th>
                <td><input type="number" min="0" max="10" step="0.1" name="scorecuoiki"></td>
            </tr>
            </tbody>
        </table>
        <button type="submit">
            Login
        </button>
    </form>
</div>
<script>
    function createScore(e, num) {
        if (num == 1) {
            let score15p = document.querySelectorAll("input.score15p").length
            if (score15p < {{rule_15p.max}})
            {
                let h = `<td><input class="score15p" type="number" min="0" max="10" step="0.1" name="score15p"></td>`
                e.parentElement.insertAdjacentHTML("beforebegin", h)
            }else{
                alert("Max collumn is {{rule_15p.max}}")
            }
        }
        if (num == 2) {
            let score1tiet = document.querySelectorAll("input.score1tiet").length
            if (score1tiet < {{rule_1tiet.max}})
            {
                let h = `<td><input class="score1tiet" type="number" min="0" max="10" step="0.1" name="score1tiet"></td>`
                e.parentElement.insertAdjacentHTML("beforebegin", h)
            }else{
                alert("Max collumn is {{rule_1tiet.max}}")
            }
        }
    }

        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById('scoresheetForm');
            form.addEventListener('submit', function (event) {
                const inputs = form.querySelectorAll('input[type="number"]');
                for (let i = 0; i < inputs.length; i++) {
                    if (!inputs[i].value) {
                        alert('Vui lòng nhập đầy đủ điểm số');
                        event.preventDefault(); // Ngăn form được gửi đi nếu có trường chưa nhập
                        return;
                    }
                }
            });
        });
</script>
{% endblock %}